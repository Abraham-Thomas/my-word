# 长连接与HTTP特性

属于HTTP1.1的机制，通过请求头**keep-alive**头域信息控制。

HTTP1.0默认请求服务返回没有keep-alivie。但在HTTP1.0中，如果要建立长连接，也可在请求信息中包含Connection: keep-alive头域信息，如果服务器能识别这条连接的头域信息，则会在响应头域中也包含一个Connection: keep-alive返回，表示后面的文件请求可以复用之前的连接传输。

在HTTP1.1中，任何HTTP请求的报文头部域都会默认包含keep-alive。keep-alive的控制可以让客户端到服务器端之间的连接在一段时间内持续有效，这样可以减少文件请求建立和关闭连接的开销。不过，长连接请求机制并不会节省传输内容的网络开销。

如果将Connection设置为close，长连接关闭。



[HTTP1.1的详细解读]: https://datatracker.ietf.org/doc/rfc2616/?include_text=1

### 一般HTTP的特点：

**无连接**：每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。**Keep-Alive **功能使客户端到服务器端的连接持续有效，当出现对服务器的后继请求时，Keep-Alive 功能避免了建立或者重新建立连接。

**无状态**：浏览器从服务器请求信息，服务端不会保留相关连接信息，没有记忆。发送到响应，完成后连接就关闭了。由于每个请求都是独立的，Keep-Alive 也没能改变这个结果。



### 完整的HTTP请求步骤：

1、建立TCP连接。

2、浏览器向服务器发送请求命令。

3、浏览器发送请求头信息。

4、服务器应答。

5、服务器发送响应头信息。

6、服务器向浏览器发送数据。

7、服务器关闭TCP连接。

**HTTP请求一般由四部分组成：**

- 1、请求的方法或动作，比如GET/POST
- 2、正在请求的URL
- 3、请求头，包含一些客户端环境信息，身份验证信息。
- 4、请求体、也叫请求正文，客户提交的字符串，表单等信息。

**HTTP响应一般三部分组成：**

1、一个由数字和文字组成的状态码，显示请求结果的状态。

2、响应头，包含服务器类型、内容类型、日期、长度等。

3、响应体，也叫响应正文。